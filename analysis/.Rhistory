layout(matrix(seq_len(l), nrow = nplt[1], ncol = nplt[2]))
for(i in term) {
upr <- CI[[i]]$upper
lwr <- CI[[i]]$lower
ylim <- range(upr, lwr)
plot(x$eval[,i], x[[i]]$deriv, type = "n",
ylim = ylim, ylab = ylab, xlab = xlab[i], main = main[i], ...)
if(isTRUE(polygon)) {
polygon(c(x$eval[,i], rev(x$eval[,i])),
c(upr, rev(lwr)), col = col, border = border)
} else {
lines(x$eval[,i], upr, lty = "dashed")
lines(x$eval[,i], lwr, lty = "dashed")
}
abline(h = 0, ...)
if(isTRUE(sizer)) {
lines(x$eval[,i], x[[i]]$deriv, lwd = 1)
S <- signifD(x[[i]]$deriv, x[[i]]$deriv, upr, lwr,
eval = eval)
lines(x$eval[,i], S$incr, lwd = lwd, col = "blue")
lines(x$eval[,i], S$decr, lwd = lwd, col = "red")
} else {
lines(x$eval[,i], x[[i]]$deriv, lwd = 2)
}
}
layout(1)
invisible(x)
}
plotGAMSignificantSlopes(mLen,"phonlengthscale","Length")
plotGAMSignificantSlopes(mAoA,"phonlengthscale","Length")
gxpc123 = grid.arrange(gpc1, gpc2, nrow=1, widths=c(0.8,1))
mSwadesh = update(m0,~.+
Swadesh)
lrtest(mSwadesh)
---
title: "Cognitive influences in language evolution: English data"
output:
pdf_document:
toc: true
---
# Introduction
This is the model code for Monaghan & Roberts, "Cognitive influences in language evolution: Psycholinguistic predictors of loan word borrowing".  It takes data from the WOLD database of borrowing for English and tries to predict whether a word has been borrowed or not according to various psycholinguitic measures.
The main fields in the data frame are:
-  word: Orthographic form
-  borrowing: variable from WOLD indicating level of evidence for borrowing:
-  1 = definately borrowed
-  5 = no evidence of borrowing
-  age_oldest, age_youngest: Dates from WOLD indicating estiamte of data of entry into English
-  phonology:  Phonological form
-  phonlength:  Number of segments in the phonological form
-  AoA: Age of acquisition ratings from Kuperman, Stadthagen-Gonzalez, and Brysbaert (2012).
-  AoA_obj: Objective, test-based age of acuqisition from Brysbaert & Biemiller (2017)
-  subtlexzipf:  Log frequency of word from the SUBTLEX database
-  conc:  Concreteness ratings from Brysbaert, Warriner, & Kuperman (2014)
-  cat: Dominant part of speech according to SUBTLEX.
-  bor15:  Conversion of the WOLD borrowing variable into a numeric (0 = not borrowed, 1 = borrowed)
```{r echo=F,eval=F}
setwd("~/Documents/MPI/MonaghanAoA/Stats 2/analysis/")
```
# Load libraries
```{r warning=F, message=F}
library(mgcv)
library(sjPlot)
library(lattice)
library(ggplot2)
library(dplyr)
library(party)
library(lmtest)
library(gridExtra)
library(scales)
library(itsadug)
library(ggfortify)
library(factoextra)
library(gridExtra)
library(reshape2)
library(binom)
logit2per = function(X){
return(exp(X)/(1+exp(X)))
}
rescaleGam = function(px, n, xvar, xlab=""){
y = logit2per(px[[n]]$fit)
x = px[[n]]$x *attr(xvar,"scaled:scale") + attr(xvar,"scaled:center")
se.upper = logit2per(px[[n]]$fit+px[[n]]$se)
se.lower = logit2per(px[[n]]$fit-px[[n]]$se)
dx = data.frame(x=x,y=y,ci.upper=se.upper,ci.lower=se.lower)
plen = ggplot(dx, aes(x=x,y=y))+
geom_ribbon(aes(ymin=ci.lower,ymax=ci.upper), alpha=0.3)+
geom_line(size=1) +
xlab(xlab)+
ylab("Probability of borrowing")+
coord_cartesian(ylim = c(0,1))
return(plen)
}
# Code for assessing significance of GAM slopes
source("GAM_derivaties.R")
```
# Load data
```{r}
dataloan <- read.csv("../data/loanword9.csv",stringsAsFactors = F)
dataloan$bor15 <- ifelse(dataloan$borrowing==1,1, ifelse(dataloan$borrowing==5,0,NA))
dataloan$bor15.cat <- factor(dataloan$bor15)
```
Convert to numbers.
```{r warning=F}
dataloan$subtlexzipf = as.numeric(dataloan$subtlexzipf)
dataloan$AoA = as.numeric(dataloan$AoA)
dataloan$conc = as.numeric(dataloan$conc)
aoaSD = sd(dataloan$AoA,na.rm = T)
aoaMean = mean(dataloan$AoA/aoaSD,na.rm=T)
dataloan$cat = factor(dataloan$cat)
```
Select only complete cases.
```{r}
dataloan2 = dataloan[complete.cases(dataloan[,
c("phonlength","AoA",
"subtlexzipf", "cat",
'conc','bor15')]),]
```
Scale and center:
```{r}
dataloan2$AoAscale <- scale(dataloan2$AoA)
dataloan2$subtlexzipfscale <- scale(dataloan2$subtlexzipf)
phonlength.center = median(dataloan2$phonlength)
dataloan2$phonlengthscale <-
dataloan2$phonlength - phonlength.center
phonlength.scale = sd(dataloan2$phonlengthscale)
dataloan2$phonlengthscale = dataloan2$phonlengthscale/phonlength.scale
attr(dataloan2$phonlengthscale,"scaled:scale") = phonlength.scale
attr(dataloan2$phonlengthscale,"scaled:center") = phonlength.center
dataloan2$concscale <- scale(dataloan2$conc)
conc.scale = attr(dataloan2$concscale,"scaled:scale")
conc.center = attr(dataloan2$concscale,"scaled:center")
dataloan2$cat = relevel(dataloan2$cat,"Noun")
dataloan2$AoA_objscaled = scale(dataloan2$AoA_obj)
dataloan2$source.language[dataloan2$bor15==0] = "English"
dataloan2$source.language = factor(dataloan2$source.language)
dataloan2$SLMWL = scale(log(dataloan2$source.language.mean.word.length))
dataloan2$SWF = scale(dataloan2$source.language.word.freq)
```
Identify Swadesh words:
```{r}
swd = read.csv("../data/SwadeshConcepts.txt", header = F, stringsAsFactors = F)$V1
dataloan2$Swadesh = dataloan2$word %in% swd
```
mSwadesh = update(m0,~.+
Swadesh)
mSwadesh = update(m0,~. + Swadesh)
summary(m0)
m0 = bam(bor15.cat ~
s(phonlengthscale) +
s(AoAscale) +
s(subtlexzipfscale) +
s(concscale) +
s(cat,bs='re')+
s(cat,phonlengthscale,bs='re')+
s(cat,AoAscale,bs='re')+
s(cat,subtlexzipfscale,bs='re')+
s(cat,concscale,bs='re'),
data = dataloan2,
family='binomial')
mSwadesh = update(m0,~. + Swadesh)
lrtest(m0,mSwadesh)
mSwadesh = update(m0,~. + s(phonlengthscale,by=Swadesh))
summary(m0)
mSwadesh = update(m0,~. + s(phonlengthscale,by=Swadesh))
mSwadesh = bam(bor15.cat ~
s(phonlengthscale) +
s(AoAscale) +
s(subtlexzipfscale) +
s(concscale) +
s(cat,bs='re')+
s(cat,phonlengthscale,bs='re')+
s(cat,AoAscale,bs='re')+
s(cat,subtlexzipfscale,bs='re')+
s(cat,concscale,bs='re') +
s(phonlengthscale,by=Swadesh),
data = dataloan2,
family='binomial')
dataloan2$Swadesh
dataloan2$Swadesh = factor(dataloan2$Swadesh)
mSwadesh = bam(bor15.cat ~
s(phonlengthscale) +
s(AoAscale) +
s(subtlexzipfscale) +
s(concscale) +
s(cat,bs='re')+
s(cat,phonlengthscale,bs='re')+
s(cat,AoAscale,bs='re')+
s(cat,subtlexzipfscale,bs='re')+
s(cat,concscale,bs='re') +
s(phonlengthscale,by=Swadesh),
data = dataloan2,
family='binomial')
dataloan2$Swadesh=factor(dataloan2$Swadesh)
mSwadesh = update(m0,~.+
s(phonlengthscale,by=Swadesh))
lrtest(m0,mSwadesh)
summary(m0)
mSwadeshAoA = update(m0,~.+
s(AoAscale,by=Swadesh))
lrtest(m0,mSwadeshAoA)
mSwadesh = update(m0,~.+Swadesh)
mSwadeshLen = update(mSwadesh,~.+
s(phonlengthscale,by=Swadesh))
lrtest(mSwadesh)
lrtest(mSwadesh,mSwadeshLen)
mSwadeshAoA = update(mSwadesh,~.+
s(AoAscale,by=Swadesh))
lrtest(mSwadesh,mSwadeshAoA)
summary(m0)
mSwadeshFreq = update(mSwadesh,~.+
s(subtlexzipfscale,by=Swadesh))
lrtest(mSwadesh,mSwadeshFreq)
table(dataloan2$Swadesh)
summary(mSwadeshLen)
mSwadeshFreq = update(mSwadesh,~.+
s(subtlexzipfscale,by=Swadesh))
lrtest(mSwadesh,mSwadeshFreq)
```
Same for Concreteness:
```{r}
mSwadeshConc = update(mSwadesh,~.+
s(concscale,by=Swadesh))
lrtest(mSwadesh,mSwadeshConc)
---
title: "Cognitive influences in language evolution: Rates of change"
output: pdf_document
---
```{r echo=F,eval=F}
setwd("~/Documents/MPI/MonaghanAoA/Stats 2/analysis/")
```
```{r echo=F}
getMEText = function(r,ef, wald=NULL, showWald=F){
AIC = r[2,]$AIC
loglikDiff = signif(diff(r$logLik),2)
chi = round(r$Chisq[2],2)
df = r$`Chi Df`[2]
p = signif(r$`Pr(>Chisq)`[2],2)
wald.text = ""
if(!is.null(wald)){
est = signif(wald[1],2)
stder = signif(wald[2],2)
t = signif(wald[3],2)
wptext = ""
wald.text =  paste("beta = ",est,",")
if(showWald){
if(!is.na(wald[4])){
wptext = paste(", Wald p =",signif(wald[4],2))
}
wald.text = paste("beta = ",est,", std.err = ",stder, ", Wald t = ",t,wptext,';')
}
}
begin = 'There was no significant'
if(p <0.09){
begin = "There was a marginal"
}
if(p < 0.05){
begin = 'There was a significant'
}
return(paste(begin,ef,"(",wald.text,"log likelihood difference =",
loglikDiff,", df = ",df,", Chi Squared =", chi,", p = ",p,")."))
}
```
# Introduction
We test whether rates of lexical replacement can be predicted by age of acuisition.  The key variables in the dataset `pagel/loanword9.csv` are:
-  word: orthographic form
-  borrowing: whether the word is borrowed into English, according to WOLD
-  phonology: phonological form, according to CELEX
-  phonlength: number of phonological segments
-  AoA: age of acuqisition, according to Kuperman et al. (2012)
-  subtlexzipf: frequency from SUBTLEX
-  pagel_rate:  rate of lexical replacement according to Pagel, Atkinson & Meade (2007)
-  cat: part of speech of the word
Pagel, Atkinson & Meade find that lexical replacement rates are higher for less frequent words, though the baseline rate differs by part of speech.  We use mixed effects modelling to investigate the effects of length, age of acquisition and concreteness, with random intercepts for part of speech.
# Load libraries
```{r message=FALSE, warning=F}
library(lme4)
library(sjPlot)
library(ggplot2)
library(gplots)
library(gridExtra)
library(mgcv)
```
# Load data
Scale and center all variables:
```{r}
d = read.csv("../data/pagel/loanword9.csv", stringsAsFactors = F)
d$pagel_rate = as.numeric(d$pagel_rate)
d$AoA = as.numeric(d$AoA)
d$subtlexzipf = as.numeric(d$subtlexzipf)
d$phonlength = as.numeric(d$phonlength)
d$conc = as.numeric(d$conc)
# group borrowing confidence
d$borrowing[d$borrowing==2] = 1
d$borrowing[d$borrowing==3] = NA
d$borrowing[d$borrowing==4] = 5
d$borrowing[d$borrowing==7] = NA
# complete cases only
d = d[complete.cases(d[,c("borrowing",'AoA','phonlength','conc','pagel_rate')]),]
d$borrowing
plotmeans(d$pagel_rate~d$borrowing)
d$borrowing = factor(d$borrowing,levels=c(5,1),labels = c("no","yes"))
d$borrowing.num = as.numeric(d$borrowing)-1
---
title: "Cognitive influences in language evolution: Rates of change"
output: pdf_document
---
```{r echo=F,eval=F}
setwd("~/Documents/MPI/MonaghanAoA/Stats 2/analysis/")
```
```{r echo=F}
getMEText = function(r,ef, wald=NULL, showWald=F){
AIC = r[2,]$AIC
loglikDiff = signif(diff(r$logLik),2)
chi = round(r$Chisq[2],2)
df = r$`Chi Df`[2]
p = signif(r$`Pr(>Chisq)`[2],2)
wald.text = ""
if(!is.null(wald)){
est = signif(wald[1],2)
stder = signif(wald[2],2)
t = signif(wald[3],2)
wptext = ""
wald.text =  paste("beta = ",est,",")
if(showWald){
if(!is.na(wald[4])){
wptext = paste(", Wald p =",signif(wald[4],2))
}
wald.text = paste("beta = ",est,", std.err = ",stder, ", Wald t = ",t,wptext,';')
}
}
begin = 'There was no significant'
if(p <0.09){
begin = "There was a marginal"
}
if(p < 0.05){
begin = 'There was a significant'
}
return(paste(begin,ef,"(",wald.text,"log likelihood difference =",
loglikDiff,", df = ",df,", Chi Squared =", chi,", p = ",p,")."))
}
```
# Introduction
We test whether rates of lexical replacement can be predicted by age of acuisition.  The key variables in the dataset `pagel/loanword9.csv` are:
-  word: orthographic form
-  borrowing: whether the word is borrowed into English, according to WOLD
-  phonology: phonological form, according to CELEX
-  phonlength: number of phonological segments
-  AoA: age of acuqisition, according to Kuperman et al. (2012)
-  subtlexzipf: frequency from SUBTLEX
-  pagel_rate:  rate of lexical replacement according to Pagel, Atkinson & Meade (2007)
-  cat: part of speech of the word
Pagel, Atkinson & Meade find that lexical replacement rates are higher for less frequent words, though the baseline rate differs by part of speech.  We use mixed effects modelling to investigate the effects of length, age of acquisition and concreteness, with random intercepts for part of speech.
# Load libraries
```{r message=FALSE, warning=F}
library(lme4)
library(sjPlot)
library(ggplot2)
library(gplots)
library(gridExtra)
library(mgcv)
```
# Load data
Scale and center all variables:
```{r}
d = read.csv("../data/pagel/loanword9.csv", stringsAsFactors = F)
d$pagel_rate = as.numeric(d$pagel_rate)
d$AoA = as.numeric(d$AoA)
d$subtlexzipf = as.numeric(d$subtlexzipf)
d$phonlength = as.numeric(d$phonlength)
d$conc = as.numeric(d$conc)
# group borrowing confidence
d$borrowing[d$borrowing==2] = 1
d$borrowing[d$borrowing==3] = NA
d$borrowing[d$borrowing==4] = 5
d$borrowing[d$borrowing==7] = NA
# complete cases only
d = d[complete.cases(d[,c("borrowing",'AoA','phonlength','conc','pagel_rate')]),]
```
Plot raw data:
```{r}
plotmeans(d$pagel_rate~d$borrowing)
ggplot(d, aes(AoA, as.numeric(pagel_rate))) +
geom_point() + stat_smooth(method="lm") +
ylab("Rate of replacement")
```
Scale variables for analysis:
```{r}
d$pagel_rate = scale(d$pagel_rate)
d$AoA.scale = scale(d$AoA)
d$subtlexzipf.scale = scale(d$subtlexzipf)
d$phonlength.scale = scale(d$phonlength)
d$conc.scale = scale(d$conc)
# most frequent category as intercept
d$borrowing = factor(d$borrowing,levels=c(5,1),labels = c("no","yes"))
d$borrowing.num = as.numeric(d$borrowing)-1
d$borrowing
m0.Study1  = bam(borrowing~
s(phonlength.scale, k=5) +
s(subtlexzipf.scale) +
s(AoA.scale) +
s(cat,bs='re'),
data = d)
summary(m0.Study1)
dataloan2$bor15.cat
d$borrowing
m0.Study1  = bam(borrowing~
s(phonlength.scale, k=5) +
s(subtlexzipf.scale) +
s(AoA.scale) +
s(cat,bs='re'),
data = d)
d$phonlength.scale
d$cat = factor(d$cat)
d$cat = relevel(d$cat,"Noun")
m0.Study1  = bam(borrowing~
s(phonlength.scale, k=5) +
s(subtlexzipf.scale) +
s(AoA.scale) +
s(cat,bs='re'),
data = d)
sum(!complete.cases(d))
d$borrowing
table(d$borrowing)
sum(is.na(d$borrowing))
m0.Study1  = bam(borrowing~
s(phonlength.scale, k=5) +
s(subtlexzipf.scale) +
s(AoA.scale) +
s(cat,bs='re'),
data = d)
m0.Study1  = bam(borrowing~
s(phonlength.scale, k=5) +
s(subtlexzipf.scale) +
s(AoA.scale) +
s(cat,bs='re'),
family="binomial",
data = d)
summary(m0.Study1)
plot(m0.Study1)
plotGAMSignificantSlopes(m0.Study1)
plotGAMSignificantSlopes(m0.Study1,"phonlength","Length")
?char
?"chartr"
x = "sdas"
rev(x)
chartr(s,"a",s)
x = "bcdef"
chartr(s,"a",s)
s = "bcdef"
chartr(s,"a",s)
chartr(s,s,s)
tolower(s)
substr(paste0("A",tolower(s)),2)
?substr(paste0("A",tolower(s)),2)
substring(paste0("A",tolower(s)),2)
substring(paste0(tolower(s),"A"),2)
?paste0
cat("A","B")
x = function(s)chartr(s,"a",s)
x=function(s)substring(paste0(tolower(s),"A"),2)
test = function(t){
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
}
testStrings = c("a","b","ab","ba","aa",
"'","'\"","\\\\",'"','""',
'‘','’',"~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
x("A")
t = "A"
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
all(sapply(testStrings,test))
testStrings
x = function(s)chartr(s,"a",s)
x=function(s)substring(paste0(tolower(s),"A"),2)
test = function(t){
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
}
testStrings = c("a","b","ab","ba","aa","A","AB",
"'","'\"","\\\\",'"','""',
'‘','’',"~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
m0.Study1  = lmer(borrowing~
phonlength.scale +
subtlexzipf.scale +
AoA.scale +
(1|cat),
family="binomial",
data = d)
summary(m0.Study1)
range(d$subtlexzipf.scale)
range(d$subtlexzipf)
range(dataloan2$subtlexzipf)
m0.Study1  = glmer(borrowing~
phonlength.scale +
subtlexzipf.scale +
AoA.scale +
(1|cat),
family="binomial",
data = d)
summary(m0.Study1)
